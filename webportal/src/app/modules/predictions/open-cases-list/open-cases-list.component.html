<nz-breadcrumb>
    <nz-breadcrumb-item>Home</nz-breadcrumb-item>
    <nz-breadcrumb-item>{{logName}}</nz-breadcrumb-item>
    <nz-breadcrumb-item>Robotic Process Automation</nz-breadcrumb-item>
    <nz-breadcrumb-item>Open Cases</nz-breadcrumb-item>
</nz-breadcrumb>

<nz-layout>
    <nz-sider nzWidth="200px" nzTheme="light">
        <ul nz-menu nzMode="inline" class="sider-menu">
            <li nz-menu-item [routerLink]="['/models']">
                <i nz-icon nzType="unordered-list" nzTheme="outline"></i>
                <span>Trained Models</span>
            </li>
            <li nz-menu-item [routerLink]="['/cases/open']" nzSelected>
                <i nz-icon nzType="unordered-list" nzTheme="outline"></i>
                <span>Open Cases</span>
            </li>
        </ul>
    </nz-sider>
    <nz-content>
        <nz-page-header [nzGhost]="false">
            <nz-page-header-title>Open Cases</nz-page-header-title>
        </nz-page-header>

        <div class="inner-content">
            <nz-table #basicTable nzSize="small" [nzData]="openCases" class="cases">
                <thead>
                    <tr>
                        <th>Case</th>
                        <th nzWidth="80px">Status</th>
                        <th>Last Assigned</th>
                        <th>Automation</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let case of basicTable.data">
                    <td>
                        <b>Case #{{case.caseId}}</b><br />
                        {{case.currentActivity}}
                    </td>
                    <td>
                        <nz-tag *ngIf="case.state == 1" nzColor="orange">OPEN</nz-tag>
                    </td>
                    <td><nz-avatar nzIcon="user" nzSize="small"></nz-avatar> {{case.currentResource}}</td>
                    <td>
                        <b>Next Activity</b><br />
                        {{case.nextActivity}} ({{case.nextActivityScore * 100 | number : '1.1-1'}} %)
                    </td>
                    <td>
                        <a (click)="showSingleCase(case.caseId)">Show Case</a>
                    </td>
                    </tr>
                </tbody>
            </nz-table>

            <div class="single-case" *ngIf="case">
                <h3>Case Info</h3>
                <nz-descriptions nzSize="small" [nzColumn]="1" nzBordered>
                    <nz-descriptions-item nzTitle="Case Id">{{case.caseId}}</nz-descriptions-item>
                    <nz-descriptions-item nzTitle="Original Id">{{case.originalCaseId}}</nz-descriptions-item>
                    <nz-descriptions-item nzTitle="Start">{{case.timestampStart | date : 'dd.MM.yyyy HH:mm'}}</nz-descriptions-item>
                    <nz-descriptions-item nzTitle="Last Event">{{case.timestampEnd | date : 'dd.MM.yyyy HH:mm'}}</nz-descriptions-item>
                </nz-descriptions>

                <h3>Events</h3>
                <nz-timeline>
                    <nz-timeline-item *ngFor="let event of case.events">
                        {{event.timestamp | date : 'dd.MM.yyyy HH:mm'}} {{event.resource}}
                        <br />{{event.activity.name}} 
                    </nz-timeline-item>
                </nz-timeline>
            </div>
        </div>
    </nz-content>
</nz-layout>
